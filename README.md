# 校園接駁車預約系統 🚌

一個基於 Java 物件導向設計的校園接駁車線上預約系統，提供學生便捷的交通預約服務。

## 📋 功能特色

### 🔐 用戶管理
- 簡易登入/註冊系統
- 左右雙欄卡片式登入介面
- 多用戶獨立預約記錄
- 違規停權機制（3次違規停權3個月）

### 🚍 班次管理
- **4條主要路線**：
  - 中央大學 ↔ 桃園高鐵站
  - 中央大學 ↔ 中壢火車站
- **每日6個時段**：08:00, 09:30, 11:00, 13:30, 15:00, 16:30
- **30天預約期間**：支援從當天起30天內的預約
- 即時座位狀態更新

### 🪑 座位選擇
- 視覺化座位圖（20人座巴士佈局）
- 即時座位可用性顯示
- 防止重複預約同一座位
- 座位狀態即時同步

### 📅 預約管理
- 個人預約記錄查看
- 智慧狀態標示：
  - 3天內：「即將到來」
  - 超過3天：「X天後」
- 取消預約功能
- 逾時取消計入違規（發車前30分鐘內取消）

### 🔍 查詢功能
- 依日期、時間和路線篩選班次
- 快捷按鈕（今天、明天、常用路線）
- 即時可用座位數顯示
- 自動過濾已過期班次

## 🛠️ 技術架構

### 後端
- **語言**：Java 8+
- **架構**：原生 HTTP Server + 物件導向設計
- **設計模式**：
  - 領域驅動設計（DDD）
  - 資料存取物件（DAO）
  - 服務層模式
- **核心類別**：
  - `Member`：會員管理
  - `Route`：路線資訊
  - `Trip`：班次管理
  - `Seat`：座位管理
  - `Reservation`：預約記錄
  - `ReservationManager`：預約業務邏輯
  - `DataStore`：資料儲存

### 前端
- **語言**：HTML5, CSS3, JavaScript (ES6+)
- **設計**：響應式設計
- **配色**：#9BB7D4, #E4DFD8, #3A4E6B
- **特色**：
  - 左右雙欄卡片式登入介面
  - 平滑動畫效果
  - 視覺化座位選擇
  - 即時狀態更新

## 🚀 快速開始

### 環境需求
- Java 8 或以上版本
- 支援的作業系統：Windows, macOS, Linux

### 安裝步驟

1. **克隆專案**
   ```bash
   git clone https://github.com/yenyu3/campus-shuttle-booking.git
   cd campus-shuttle-booking
   ```

2. **編譯後端**
   ```bash
   javac -encoding UTF-8 SimpleApp.java
   ```

3. **啟動服務**
   ```bash
   java SimpleApp
   ```
   
   你應該會看到：
   ```
   系統初始化：共生成 720 筆班次資料。
   Server started at http://localhost:8080
   ```

4. **訪問系統**
   - 開啟瀏覽器
   - 前往 `http://localhost:8080`
   - 使用任意學號和密碼登入（系統會自動創建帳號）

### 🖥️ 使用說明

#### 登入/註冊
1. 在登入頁面輸入學號和密碼
2. 新用戶可點擊「立即註冊」切換到註冊表單
3. 填寫學號、姓名、電子郵件、密碼
4. 註冊成功後返回登入頁面

#### 查詢班次
1. 選擇預約日期（可使用快捷按鈕）
2. 選擇路線（4條路線可選）
3. 可選擇時間篩選（只顯示該時間之後的班次）
4. 點擊「查詢」查看可用班次

#### 預約座位
1. 在班次列表中點擊「選位預約」
2. 在座位圖中選擇可用座位（灰色可選，藍色已選，紅色不可用）
3. 點擊「確認預約」完成預約
4. 系統會檢查是否停權

#### 管理預約
- 在「我的預約」區域查看所有預約記錄
- 點擊「刪除」按鈕可取消預約
- 發車前30分鐘內取消會計入違規
- 違規3次將停權3個月

## 📁 專案結構

```
campus-shuttle-booking/
├── SimpleApp.java          # 後端主程式（包含所有類別）
├── index.html             # 前端主頁面（含登入/註冊）
├── script.js              # 前端JavaScript邏輯
├── style.css              # 前端樣式表
├── login.html             # 獨立登入頁面（備用）
├── login-style.css        # 登入頁面樣式（備用）
├── login-script.js        # 登入頁面邏輯（備用）
├── pom.xml                # Maven配置文件
└── README.md              # 專案說明文件
```

## 🏗️ 系統架構

### 後端類別結構

```
SimpleApp (主程式)
├── Member (會員)
├── Route (路線)
├── Trip (班次)
├── Seat (座位)
├── Reservation (預約)
├── ReservationManager (預約管理器)
├── DataStore (資料儲存)
└── HTTP Handlers
    ├── LoginHandler
    ├── ScheduleHandler
    ├── ReservationHandler
    └── StaticFileHandler
```

### 業務邏輯流程

1. **預約流程**：
   - 用戶登入 → 查詢班次 → 選擇座位 → 確認預約
   - 系統檢查停權狀態 → 檢查座位可用性 → 創建預約

2. **取消流程**：
   - 用戶選擇預約 → 點擊刪除 → 確認取消
   - 系統檢查取消時間 → 判斷是否違規 → 釋放座位

3. **違規處理**：
   - 逾時取消（發車前30分鐘內）→ 違規次數+1
   - 違規3次 → 停權3個月
   - 停權期滿 → 自動解除

## 🔧 API 文檔

### 登入
- **POST** `/api/login`
- Body: `{"username": "學號", "password": "密碼"}`
- Response: `{"success": true, "studentId": "學號"}`

### 查詢班次
- **GET** `/api/schedules?date=YYYY-MM-DD&time=HH:mm&route=路線名稱`
- Response: 班次列表（含座位狀態）

### 查詢個人預約
- **GET** `/api/bookings/{studentId}`
- Response: 預約列表（含班次資訊）

### 建立預約
- **POST** `/api/bookings`
- Body: `{"studentId": "學號", "scheduleId": "班次ID", "seatNumber": "座位號"}`
- Response: `{"id": "預約ID", "success": true}`

### 取消預約
- **DELETE** `/api/bookings/{bookingId}?studentId=學號`
- Response: `{"success": true}`

## 🎨 UI 設計

### 配色方案
- **主色調**：#9BB7D4（柔和藍）
- **輔助色**：#E4DFD8（米白色）
- **強調色**：#3A4E6B（深藍）
- **警告色**：#F56565（淺紅）

### 設計特點
- 左右雙欄卡片式登入介面
- 平滑的切換動畫
- 響應式設計（支援手機、平板、桌面）
- 視覺化座位選擇
- 清晰的狀態提示

## ⚠️ 注意事項

- 資料儲存在記憶體中，重啟伺服器後資料會清空
- 確保 8080 端口沒有被其他程式占用
- 所有前端文件必須在同一目錄下
- 違規停權機制會自動執行
- 停權期滿會自動解除

## 📝 開發紀錄

### v2.0 (2024-12-09)
- 重構後端使用完整 OOP 架構
- 新增違規停權機制
- 改善預約管理邏輯
- 優化座位管理系統

### v1.0 (2024-11-23)
- 完成基礎預約功能
- 實作登入/註冊介面
- 設計視覺化座位圖
- 統一 UI 配色方案

## 📄 授權

本專案僅供學習使用。
